(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7d776930"],{5197:function(t,e,l){"use strict";l("9f44")},8062:function(t,e,l){"use strict";l.r(e);var a=function(){var t=this,e=t.$createElement,l=t._self._c||e;return l("div",[l("span",{staticStyle:{"margin-top":"20px","margin-left":"25px","font-size":"40px"}},[t._v("正在生产的计划："+t._s(this.nowPlanNo))]),l("span",{staticStyle:{"margin-top":"20px","margin-left":"25px","font-size":"40px"}},[t._v("合格数："+t._s(this.nowPlanActualNum))]),l("span",{staticStyle:{"margin-top":"20px","margin-left":"25px","font-size":"40px"}},[t._v("手动焊接数："+t._s(this.nowPlanFailNum))]),l("el-form",{staticClass:"demo-form-inline",staticStyle:{"margin-top":"20px","margin-left":"25px"},attrs:{inline:!0,model:t.planCondition}},[l("el-form-item",{attrs:{label:"计划号"}},[l("el-autocomplete",{staticClass:"inline-input",attrs:{"fetch-suggestions":t.querySearch1,placeholder:"请输入计划编号查询","trigger-on-focus":!1},on:{select:t.handleSelect},model:{value:t.planCondition.planNo,callback:function(e){t.$set(t.planCondition,"planNo",e)},expression:"planCondition.planNo"}})],1),l("el-form-item",{attrs:{label:"计划状态"}},[l("el-select",{attrs:{placeholder:"选择状态"},model:{value:t.planCondition.planStatus,callback:function(e){t.$set(t.planCondition,"planStatus",e)},expression:"planCondition.planStatus"}},[l("el-option",{attrs:{label:"已完成",value:"1"}}),l("el-option",{attrs:{label:"未完成",value:"0"}})],1)],1),l("el-form-item",[l("el-date-picker",{attrs:{type:"datetime",placeholder:"选择开始日期","picker-options":t.pickerOptions},model:{value:t.planCondition.beginTime,callback:function(e){t.$set(t.planCondition,"beginTime",e)},expression:"planCondition.beginTime"}})],1),l("el-form-item",[l("el-date-picker",{attrs:{type:"datetime",placeholder:"选择结束日期","picker-options":t.pickerOptions},model:{value:t.planCondition.endTime,callback:function(e){t.$set(t.planCondition,"endTime",e)},expression:"planCondition.endTime"}})],1),l("el-form-item",[l("el-button",{attrs:{type:"primary"},on:{click:t.onSubmit}},[t._v("查询")])],1),l("el-form-item",[l("el-button",{attrs:{type:"primary"},on:{click:t.handleInsert}},[t._v("新增计划")])],1),l("el-form-item",[l("el-button",{attrs:{type:"danger"},on:{click:t.deleteAll}},[t._v("批量删除")])],1)],1),l("el-table",{ref:"multipleTable",staticClass:"tablessp",staticStyle:{width:"100%","margin-top":"8px","min-height":"500px"},attrs:{data:t.tableData,height:"200","highlight-current-row":"",fit:"",border:"","default-sort":{prop:"date",order:"descending"}},on:{"selection-change":t.handleSelectionChange}},[l("el-table-column",{attrs:{type:"selection",width:"60",align:"center"}}),l("el-table-column",{attrs:{align:"center",label:"序号",width:"95",type:"index",index:t.typeIndex}}),l("el-table-column",{attrs:{prop:"planDate",label:"计划日期",align:"center",sortable:"",width:"180"}}),l("el-table-column",{attrs:{prop:"planSchedule",label:"计划班次",align:"center",sortable:"",width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){return["am"==e.row.planSchedule?l("span",[t._v("上午班")]):t._e(),"pm"==e.row.planSchedule?l("span",[t._v("下午班")]):t._e()]}}])}),l("el-table-column",{attrs:{prop:"planNo",label:"计划号",align:"center",sortable:"",width:"180"}}),l("el-table-column",{attrs:{prop:"productNo",label:"产品型号",align:"center",sortable:"",width:"180"}}),l("el-table-column",{attrs:{prop:"planNum",label:"计划数量",align:"center",sortable:"",width:"120"}}),l("el-table-column",{attrs:{prop:"actualNum",label:"合格数量",align:"center",sortable:"",width:"120"}}),l("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[l("el-button",{attrs:{size:"mini"},on:{click:function(l){return t.handleQuery(e.$index,e.row)}}},[t._v("查看所需物料 ")]),l("el-button",{attrs:{size:"mini"},on:{click:function(l){return t.handleEdit(e.$index,e.row)}}},[t._v("编辑 ")]),"1"!=e.row.status&&"1"!=e.row.planStatus?l("el-button",{attrs:{size:"mini"},on:{click:function(l){return t.startPlan(e.$index,e.row)}}},[t._v("切换计划 ")]):t._e(),"1"!=e.row.planStatus?l("el-button",{attrs:{size:"mini"},on:{click:function(l){return t.handleFinish(e.$index,e.row)}}},[t._v("一键完成 ")]):t._e(),l("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(l){return t.handleDelete(e.$index,e.row)}}},[t._v("删除 ")])]}}])})],1),l("el-dialog",{staticClass:"edit-form",attrs:{title:"新增计划",visible:t.insertFormVisible,"close-on-click-modal":!1},on:{"update:visible":function(e){t.insertFormVisible=e}}},[l("el-form",{ref:"insertForm",attrs:{model:t.insertForm,"label-width":"80px"}},[l("el-form-item",{attrs:{label:"计划号",prop:"planNo"}},[l("el-input",{attrs:{"auto-complete":"off"},model:{value:t.insertForm.planNo,callback:function(e){t.$set(t.insertForm,"planNo",e)},expression:"insertForm.planNo"}})],1),l("el-form-item",{attrs:{label:"计划班次",prop:"planSchedule"}},[l("el-select",{attrs:{placeholder:"选择班次"},model:{value:t.insertForm.planSchedule,callback:function(e){t.$set(t.insertForm,"planSchedule",e)},expression:"insertForm.planSchedule"}},[l("el-option",{attrs:{label:"上午班",value:"am"}}),l("el-option",{attrs:{label:"下午班",value:"pm"}})],1)],1),l("el-form-item",{attrs:{label:"产品型号",prop:"productNo"}},[l("el-select",{attrs:{placeholder:"选择产品"},model:{value:t.insertForm.productNo,callback:function(e){t.$set(t.insertForm,"productNo",e)},expression:"insertForm.productNo"}},t._l(t.productForm,(function(t,e){return l("el-option",{attrs:{label:t.productNo,value:t.productNo}})})),1)],1),l("el-form-item",{attrs:{label:"计划数量",prop:"planNum"}},[l("el-input",{attrs:{"auto-complete":"off"},model:{value:t.insertForm.planNum,callback:function(e){t.$set(t.insertForm,"planNum",e)},expression:"insertForm.planNum"}})],1),l("el-form-item",{attrs:{label:"计划日期",prop:"planDate"}},[l("el-date-picker",{attrs:{placeholder:"选择计划日期",format:"yyyy年MM月dd日",type:"datetime","picker-options":t.pickerOptions,"value-format":"yyyy-MM-dd HH:mm:ss"},model:{value:t.insertForm.planDate,callback:function(e){t.$set(t.insertForm,"planDate",e)},expression:"insertForm.planDate"}})],1)],1),l("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[l("el-button",{nativeOn:{click:function(e){return t.handleCancel("insertForm")}}},[t._v("取消")]),l("el-button",{attrs:{type:"primary"},nativeOn:{click:function(e){return t.Insert("insertForm")}}},[t._v("新增")])],1)],1),l("el-dialog",{staticClass:"edit-form",attrs:{title:"编辑计划",visible:t.editFormVisible,"close-on-click-modal":!1},on:{"update:visible":function(e){t.editFormVisible=e}}},[l("el-form",{ref:"editForm",attrs:{model:t.editForm,"label-width":"80px"}},[l("el-form-item",{attrs:{label:"计划号",prop:"planNo"}},[l("el-input",{attrs:{"auto-complete":"off",readonly:""},model:{value:t.editForm.planNo,callback:function(e){t.$set(t.editForm,"planNo",e)},expression:"editForm.planNo"}})],1),l("el-form-item",{attrs:{label:"计划班次",prop:"planSchedule"}},[l("el-select",{attrs:{placeholder:"选择班次"},model:{value:t.editForm.planSchedule,callback:function(e){t.$set(t.editForm,"planSchedule",e)},expression:"editForm.planSchedule"}},[l("el-option",{attrs:{label:"上午班",value:"am"}}),l("el-option",{attrs:{label:"下午班",value:"pm"}})],1)],1),l("el-form-item",{attrs:{label:"计划数量",prop:"planNum"}},[l("el-input",{attrs:{"auto-complete":"off"},model:{value:t.editForm.planNum,callback:function(e){t.$set(t.editForm,"planNum",e)},expression:"editForm.planNum"}})],1),l("el-form-item",{attrs:{label:"合格数量",prop:"actualNum"}},[l("el-input",{attrs:{"auto-complete":"off"},model:{value:t.editForm.actualNum,callback:function(e){t.$set(t.editForm,"actualNum",e)},expression:"editForm.actualNum"}})],1),l("el-form-item",{attrs:{label:"手动焊接数量",prop:"failNum"}},[l("el-input",{attrs:{"auto-complete":"off"},model:{value:t.editForm.failNum,callback:function(e){t.$set(t.editForm,"failNum",e)},expression:"editForm.failNum"}})],1),l("el-form-item",{attrs:{label:"计划日期",prop:"planDate"}},[l("el-date-picker",{attrs:{placeholder:"选择计划日期",format:"yyyy年MM月dd日","value-format":"yyyy-MM-dd HH:mm:ss"},model:{value:t.editForm.planDate,callback:function(e){t.$set(t.editForm,"planDate",e)},expression:"editForm.planDate"}})],1)],1),l("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[l("el-button",{nativeOn:{click:function(e){return t.handleCancel("editForm")}}},[t._v("取消")]),l("el-button",{attrs:{type:"primary"},nativeOn:{click:function(e){return t.handleUpdate("editForm")}}},[t._v("更新")])],1)],1),l("el-dialog",{attrs:{title:"物料所需数量",visible:t.dialogTableVisible,width:"80%"},on:{"update:visible":function(e){t.dialogTableVisible=e}}},[l("el-table",{attrs:{data:t.productBomData}},[l("el-table-column",{attrs:{align:"center",label:"序号",width:"95",type:"index",index:t.typeIndex}}),l("el-table-column",{attrs:{align:"center",property:"stationNo",label:"工位号",width:"150"}}),l("el-table-column",{attrs:{align:"center",property:"materialNo",label:"物料编号",width:"250"}}),l("el-table-column",{attrs:{align:"center",property:"materialDesc",label:"物料描述",width:"350"}}),l("el-table-column",{attrs:{align:"center",property:"productNum",label:"数量(件)",width:"100"}})],1)],1),l("el-dialog",{attrs:{title:"提示",visible:t.delVisible,width:"300px",center:""},on:{"update:visible":function(e){t.delVisible=e}}},[l("div",{staticClass:"del-dialog-cnt"},[t._v("删除不可恢复，是否确定删除？")]),l("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[l("el-button",{on:{click:function(e){t.delVisible=!1}}},[t._v("取 消")]),l("el-button",{attrs:{type:"primary"},on:{click:t.deleteRow}},[t._v("确 定")])],1)]),l("el-dialog",{attrs:{title:"提示",visible:t.finishVisible,width:"300px",center:""},on:{"update:visible":function(e){t.finishVisible=e}}},[l("div",{staticClass:"del-dialog-cnt"},[t._v("确定要补齐未正确录入的数量吗？")]),l("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[l("el-button",{on:{click:function(e){t.finishVisible=!1}}},[t._v("取 消")]),l("el-button",{attrs:{type:"primary"},on:{click:t.finishRow}},[t._v("确 定")])],1)]),l("el-pagination",{staticStyle:{"text-align":"center"},attrs:{background:"","current-page":t.current,"page-sizes":[5,10,20],"page-size":t.limit,layout:"total,prev,pager,next,sizes,jumper",total:t.total},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1)},i=[],n=(l("4de4"),l("d81d"),l("ac1f"),l("5319"),{created:function(){this.fetchPageData(1,10),this.getProductPlan()},destroyed:function(){clearInterval(this.timer)},mounted:function(){this.queryAllPlanNo(),this.timer=setInterval(this.getProductPlan,1e4)},data:function(){return{delVisible:!1,msg:"",delarr:[],multipleSelection:[],nowPlanNo:"",nowPlanActualNum:"",nowPlanFailNum:"",total:0,current:1,limit:10,pages:"0",planNoList:"",productForm:[{productNo:""}],planCondition:{planNo:"",planStatus:"",beginTime:"",endTime:""},tableData:[{id:"",planDate:"",planSchedule:"",planNo:"",productNo:"",planNum:"",actualNum:"",planStatus:"",status:""}],insertForm:{planNo:"",productNo:"",planDate:"",planNum:"",planSchedule:""},editForm:{planNo:"",planDate:"",planNum:"",actualNum:"",failNum:"",planSchedule:""},productBomData:[{id:"",stationNo:"",materialNo:"",materialDesc:"",productNum:""}],autoFillId:"",editFormVisible:!1,finishVisible:!1,insertFormVisible:!1,dialogTableVisible:!1,pickerOptions:{shortcuts:[{text:"今天",onClick:function(t){t.$emit("pick",new Date)}},{text:"昨天",onClick:function(t){var e=new Date;e.setTime(e.getTime()-864e5),t.$emit("pick",e)}},{text:"一周前",onClick:function(t){var e=new Date;e.setTime(e.getTime()-6048e5),t.$emit("pick",e)}}]}}},methods:{onSubmit:function(){this.fetchPageData(1,10)},handleSelect:function(t){console.log(t)},querySearch1:function(t,e){var l=this.planNoList,a=t?l.filter(this.createFilter1(t)):l;e(a)},createFilter1:function(t){return function(e){return 0===e.value.toLowerCase().indexOf(t.toLowerCase())}},queryAllPlanNo:function(){var t=[],e=this;this.$axios.get("http://localhost:8181/mesPrimaryProducePlan/queryAllPlanNo").then((function(l){t=l.data.map((function(t){return{value:t}})),console.log(t),e.planNoList=t}))},startPlan:function(t,e){var l=this;""!=this.nowPlanNo?this.$message({type:"error",message:"已经有正在生产的计划了，请完成后再继续该计划！"}):this.$axios.get("http://localhost:8181/mesPrimaryProducePlan/startPlanById/"+e.id).then((function(t){console.log(t.data),"开始生产"==t.data?l.$router.go(0):alert(t.data)}))},handleQuery:function(t,e){this.dialogTableVisible=!0;var l=this;this.$axios.get("http://localhost:8181/mesBom/queryByProductNo/"+e.productNo).then((function(t){console.log(t.data);for(var a=0;a<t.data.length;a++)t.data[a].productNum=t.data[a].productNum*e.planNum;l.productBomData=t.data}))},deleteRow:function(){var t=this;this.$axios.delete("http://localhost:8181/mesPrimaryProducePlan/deleteBySelectIds/"+this.delarr).then((function(e){console.log(e.data),"删除成功"==e.data?t.$router.go(0):alert("删除失败")})),this.delarr=[],this.delVisible=!1},finishRow:function(){var t=this;this.$axios.get("http://localhost:8181/mesPrimaryProducePlan/autoFillPlanById/"+this.autoFillId).then((function(e){console.log(e.data),"补充成功"==e.data?t.$router.go(0):alert(e.data)})),this.delarr=[],this.delVisible=!1},handleDelete:function(t,e){this.idx=t,this.msg=e,this.delarr.push(this.msg.id),this.delVisible=!0,console.log(this.delarr)},handleFinish:function(t,e){this.idx=t,this.msg=e,this.finishVisible=!0,this.autoFillId=e.id},deleteAll:function(){this.delVisible=!0;for(var t=this.multipleSelection.length,e=0;e<t;e++)this.delarr.push(this.multipleSelection[e].id);console.log(this.delarr)},handleInsert:function(){var t=this;this.insertFormVisible=!0,this.$axios.get("http://localhost:8181/mesProduct/queryAllProduct").then((function(e){t.productForm=e.data}))},handleEdit:function(t,e){this.editFormVisible=!0,this.editForm=Object.assign({},e),this.editForm.index=t;var l=new Date(+new Date(this.editForm.planDate)+288e5).toISOString().replace(/T/g," ").replace(/\.[\d]{3}Z/,"");this.editForm.planDate=l,console.log(this.editForm.planDate)},handleCancel:function(t){this.editFormVisible=!1},Insert:function(t){var e=this;this.$axios.post("http://localhost:8181/mesPrimaryProducePlan/addPlan",this.insertForm).then((function(t){console.log(t.data),"添加成功"==t.data?e.$router.go(0):alert(t.data)})),this.editFormVisible=!1},handleUpdate:function(t){var e=this;this.$axios.put("http://localhost:8181/mesPrimaryProducePlan/updatePlan",this.editForm).then((function(t){console.log(t.data),"修改成功"==t.data?e.$router.go(0):alert(t.data)})),this.editFormVisible=!1},typeIndex:function(t){var e=this;return(e.current-1)*e.limit+t+1},fetchPageData:function(t,e){var l=this;this.$axios.post("http://localhost:8181/mesPrimaryProducePlan/queryByList/"+t+"/"+e,this.planCondition).then((function(t){console.log(t.data.data);for(var e=0;e<t.data.data.length;e++){var a=new Date(+new Date(t.data.data[e].planDate)+288e5).toISOString().replace(/T/g," ").replace(/\.[\d]{3}Z/,"");t.data.data[e].planDate=a}l.tableData=t.data.data,l.total=t.data.total,l.pages=t.data.pages}))},handleSizeChange:function(t){var e=this;e.limit=t,e.fetchPageData(e.current,e.limit)},handleCurrentChange:function(t){var e=this;e.current=t,e.fetchPageData(e.current,e.limit)},handleSelectionChange:function(t){this.multipleSelection=t}}}),o=n,r=(l("5197"),l("2877")),s=Object(r["a"])(o,a,i,!1,null,"4fae83b6",null);e["default"]=s.exports},"9f44":function(t,e,l){}}]);